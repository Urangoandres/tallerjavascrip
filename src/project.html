<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Maqueta</title>
        <link href="../dist/output.css" rel="stylesheet">
        <script src="scripts/myscript.js"></script>
        <style>
            .caja{
                border: 1px solid rgb(40, 105, 204)
            }        

        </style>
    </head>
    <body>

        <nav class="bg-indigo-500">
            <div class="container py-2 mx-auto px-10 flex flex-wrap items-center justify-between">

                <!-- BEGIN logo --> 
                <div  class="flex items-center">
                    <img src="images/logou2.png" class="h-14"> 
                    <h2 class="text-white">Universidad de Córdoba</h2>
                </div>
                <!-- END logo -->


                <!-- ENG Botón responsive -->
                <button id="bntResponsive" class="p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-white" data-collapse-toggle="mobile-menu" type="button"  aria-controls="mobile-menu" aria-expanded="false">
                    <svg id="iconOpen" class="text-white w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                    <svg id="iconClose" class="text-white hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                </button>
                <!-- END Botón responsive -->


                <!-- BEGIN items adicionales -->
                <div class="hidden md:block md:w-auto w-full " id="mobile-menu">
                    <ul class="flex flex-col mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium">
                        <li>
                            <a href="#" class="block py-2 pr-4 pl-3 text-white bg-blue-700 rounded md:bg-transparent md:text-white md:p-0 dark:text-white" aria-current="page">Home</a>
                        </li>
                        <li>
                            <a href="#" class="block py-2 pr-4 pl-3 text-white border-b border-gray-100 hover:bg-gray-50 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 ">About</a>
                        </li>
                        <li>
                            <a href="#" class="block py-2 pr-4 pl-3 text-white border-b border-gray-100 hover:bg-gray-50 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 ">Services</a>
                        </li>
                        <li>
                            <a href="#" class="block py-2 pr-4 pl-3 text-white border-b border-gray-100 hover:bg-gray-50 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 ">Pricing</a>
                        </li>
                        <li>
                            <a href="#" class="block py-2 pr-4 pl-3 text-white hover:bg-gray-50 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 ">Contact</a>
                        </li>
                    </ul>
                </div>
                <!-- END items adicionales -->


            </div>
        </nav>

        <nav class="md:bg-gray-800 bg-gray-500 p-1">
            <div class="container mx-auto px-10 w-full">
                <ul class="flex flex-col justify-center md:flex-row mt-1 text-xs md:text-sm">
                    <li>
                        <a href="#" class="transition hover:-translate-y-1 hover:scale-110 hover:bg-indigo-500 duration-300 
                           block py-2
                           text-gray-100 border-b border-gray-400 
                           hover:rounded-md text-sm 
                           hover:bg-gray-700 
                           hover:text-gray-200
                           md:border-0 md:mx-2 md:px-3" aria-current="page">Inicio</a>
                    </li>
                    <li>
                        <a href="#" class="transition hover:-translate-y-1 hover:scale-110 hover:bg-indigo-500 duration-300 
                           block py-2
                           text-gray-100 border-b border-gray-400 hover:rounded-md text-sm hover:bg-gray-700 hover:text-gray-200
                           md:border-0 md:mx-2 md:px-3" aria-current="page">Mis Cursos</a>
                    </li>
                    <li>
                        <a href="#" class="transition hover:-translate-y-1 hover:scale-110 hover:bg-indigo-500 duration-300  
                           block py-2
                           text-gray-100 border-b border-gray-400 hover:rounded-md text-sm hover:bg-gray-700 hover:text-gray-200
                           md:border-0 md:mx-2 md:px-3" aria-current="page">Calificaciones</a>
                    </li>
                    <li>
                        <a href="#" class="transition hover:-translate-y-1 hover:scale-110 hover:bg-indigo-500 duration-300 
                           block py-2
                           text-gray-100 border-b border-gray-400 hover:rounded-md text-sm hover:bg-gray-700 hover:text-gray-200
                           md:border-0 md:mx-2 md:px-3" aria-current="page">Insignias</a>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="bg-gray-400 py-5">
            <div class="bg-white container mx-auto px-5 py-4 rounded-xl">

                <h1 class="text-center text-3xl">Mis Proyectos</h1>

                <p class="text-center mb-5">
                    Administración general de mis proyectos
                </p>

                <div class="grid md:grid-cols-3 sm:grid-cols-2 gap-5">

                    <div class="col-span-1">
                        <div class="shadow-lg p-3">
                            <h1 class="text-center text-3xl">Nuevo proyecto</h1>
                            <form action="#">
                                <table>
                                    <tr>
                                        <td>Código del proyecto</td>
                                        <td><input class="caja" type="hidden" name="posicion" id="posicion">

                                            <input class="caja" type="text" name="codigo" id="codigo"></td>
                                    </tr>
                                    <tr>
                                        <td>Nombre</td>
                                        <td>
                                            <input class="caja" type="text" name="nombre" id="nombre" onkeypress="return soloLetrasyNumeros(event)">
                                            <span id="errorNombre" class="hidden text-xs text-red-600">Datos no válidos en el nombre</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Tipo Proyecto</td>
                                        <td>
                                            <select name="tipo" id="tipo" class="caja">
                                                <option value="">Seleccione el tipo de proyecto...</option>
                                                <option value="Investigación">Investigación</option>
                                                <option value="Extensión">Extensión</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Fecha Inicio</td>
                                        <td><input class="caja" type="date" name="fecha_ini" id="fecha_ini"></td>
                                    </tr>
                                    <tr>
                                        <td>Fecha Finalización</td>
                                        <td><input class="caja" type="date" name="fecha_fin" id="fecha_fin"></td>
                                    </tr>
                                    <tr>
                                        <td>Responsable</td>
                                        <td><input class="caja" type="text" name="responsable" id="responsable" onkeypress="return soloLetrasyNumeros(event)"></td>
                                    </tr>
                                    <tr>
                                        <td>Presupuesto</td>
                                        <td><input class="caja" type="text" name="presupuesto" id="presupuesto" onkeypress="return soloNumeros(event)"></td>
                                    </tr>
                                    <tr>
                                        <td>Tipo Persona</td>
                                        <td>
                                            Estudiante
                                            <input type="radio" name="tipo_persona" id="tipo_persona" value="estudiante">
                                            Profesor
                                            <input type="radio" name="tipo_persona" id="tipo_persona" value="profesor">
                                        </td>
                                    </tr>


                                    <!-- Datos profesor -->
                                    <tr>
                                        <td>Tipo profesor</td>
                                        <td>
                                            <select name="tipo_profesor" id="tipo_profesor" class="caja">
                                                <option value="">Seleccionar</optio>
                                                <option value="Planta">Planta</option>
                                                <option value="Catedratico">Catedratico</option>
                                                <option value="Ocasional">Ocasional</option>
                                            </select>
                                        </td>
                                    </tr>


                                    <!-- Datos estudiante -->
                                    <tr>
                                        <td>Semestre Estudiante</td>
                                        <td>
                                            <select name="semestre" id="semestre" class="caja">
                                                <option value="I">I</option>
                                                <option value="II">II</option>
                                                <option value="III">III</option>
                                            </select>
                                        </td>
                                    </tr>



                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>
                                            <input type="button" id="btnAgregar" value="Registrar Proyecto" class="bg-blue-400 p-2 border border-cyan-800">

                                            <input type="button" id="btnActualizar" value="Actualizar Proyecto" class="bg-gray-400 p-2 border border-cyan-800">
                                        </td>
                                    </tr>

                                </table>
                            </form>
                        </div>                    
                    </div>


                    <div class="col-span-2">
                        <h1 class="text-center text-3xl">Listado de proyectos</h1>
                        <table class="min-w-full">
                            <thead class="bg-slate-50 border-b border-slate-200">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-slate-900">
                                        Nombre
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-slate-900">
                                        Responsable
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-slate-900">
                                        Fecha Inicio
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-slate-900">
                                        Fecha Fin
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-slate-900">
                                        Dias de Ejecución
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-sm font-medium text-slate-900">
                                        Acciones
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="tabla">




                            </tbody>
                        </table>
                    </div>
                </div>


            </div>
        </div>

        <footer class="bg-gray-700 text-center text-white py-5 text-sm">
            <div class="flex justify-center"><img src="images/logou2.png" alt=""></div>
            <div>Diplomado en desarrollo de aplicaciones orientadas a la nube</div>
            <div>Universidad de Córdoba</div>
        </footer>

        <script>
            var proyecto = [];

            /**
             Validaciones del proyecto
             ====================================
             
             1. Nombre solo letras o numeros: (alphanum)
             2. Tipo de proyecto (inv o ext)
             3. Fecha de inicio: Desde 01-01-2022 --
             4. Fecha de finalización: No menor a 01-01-2022 y no > 31-12-2022 --
             5. Responsable: (alphanum)
             6. Presupuesto: Enteros. Maximo $50.000.000. No < 10.000.000
             7. Tipo Persona (Est o Prof)
             
             */


            function soloLetrasyNumeros(e) {
                key = e.keyCode || e.which;
                tecla = String.fromCharCode(key).toLowerCase();
                letras = " abcdefghijklmnñopqrstuvwxyzABCDEFGHIJKLMNÑOPQRSTUVWXYZ1234567890";
                especiales = [8, 37, 39, 46];

                tecla_especial = false
                for (var i in especiales) {
                    if (key == especiales[i]) {
                        tecla_especial = true;
                        break;
                    }
                }

                if (letras.indexOf(tecla) == -1 && !tecla_especial)
                    return false;
            }

            function soloNumeros(e) {
                key = e.keyCode || e.which;
                tecla = String.fromCharCode(key).toLowerCase();
                letras = "1234567890";
                especiales = [8, 37, 39, 46];

                tecla_especial = false
                for (var i in especiales) {
                    if (key == especiales[i]) {
                        tecla_especial = true;
                        break;
                    }
                }

                if (letras.indexOf(tecla) == -1 && !tecla_especial)
                    return false;
            }

     
            function ValidarF_Inicial(fechainicial)
            {
                var cantidad = 0;
                if (Date.parse('2022-01-01') > Date.parse(fechainicial)) {
                    cantidad = 0;
                } else {
                    cantidad = 1;
                }
                return cantidad;
            }

            function ValidarF_Final(fechafinal)
            {
                var cantidad = 0;
                if (Date.parse('2022-01-01') > Date.parse(fechafinal)) {
                    cantidad = 0;
                } else if (Date.parse(fechafinal) > Date.parse('2022-12-31')) {
                    cantidad = 0;
                } else {
                    cantidad = 1;
                }
                return cantidad;
            }

            function Validar_Presupuesto(presupuesto)
            {
                var cantidad = 0;
                if (50000001 < presupuesto) {
                    cantidad = 0;
                } else if (presupuesto < 10000001) {
                    cantidad = 0;
                } else {
                    cantidad = 1;
                }
                return cantidad;
            }




            function limpiardatos() {
                document.getElementById('codigo').value = '';
                document.getElementById('nombre').value = '';
                document.getElementById('tipo').selectedIndex = "0";
                document.getElementById('fecha_ini').value = '';
                document.getElementById('fecha_fin').value = '';
                document.getElementById('responsable').value = '';
                document.getElementById('presupuesto').value = '';
                document.getElementById('tipo_persona').checked = false;
                document.getElementById('tipo_profesor').selectedIndex = "0";
                document.getElementById('semestre').selectedIndex = "0";
            }

            function mostrarDatos() {
                var salida = '';
                for (i = 0; i < proyecto.length; i++) {
                    var fechaInicio = new Date(proyecto[i].fecha_ini).getTime();
                    var fechaFin = new Date(proyecto[i].fecha_fin).getTime();
                    var diferencia = fechaFin - fechaInicio;
                    var dia = Math.round(diferencia / (1000 * 60 * 60 * 24));
                    salida += '<tr class="odd:bg-white even:bg-slate-50">';
                    salida += '<td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900">' + proyecto[i].codigo + '</td>';
                    salida += '<td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">' + proyecto[i].responsable + '</td>';
                    salida += '<td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">' + proyecto[i].fecha_ini + '</td>';
                    salida += '<td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">' + proyecto[i].fecha_fin + '</td>';
                    salida += ' <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">' + dia + '</td>';
                    salida += '<td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600"> <input type="button" onclick="Editar(' + i + ',' + proyecto[i].codigo + ')" value="Editar" class="bg-green-600 text-green-200 text-sm p-1 border border-green-800"> <input type="button" onclick="Eliminar(' + i + ')"  value="Eliminar" class="bg-red-600 text-red-200 text-sm p-1 border border-red-800"> <input type="button" onclick="Editar(' + i + ',' + proyecto[i].codigo + ')" value="Vista Rápida" class="bg-yellow-600 text-yellow-200 text-sm p-1 border border-yellow-800"></td>';
                    salida += '</tr>';
                    document.getElementById("tabla").innerHTML = salida;
                }

            }

            var btnA = document.getElementById("btnAgregar")
            btnA.addEventListener('click', agregarProyecto)

            function agregarProyecto() {
                // Validación

                var Rcodigo = document.getElementById('codigo').value;
                var Rnombre = document.getElementById('nombre').value;
                var Rtipo = document.getElementById('tipo').value;
                var Rfecha_ini = document.getElementById('fecha_ini').value;
                var Rfecha_fin = document.getElementById('fecha_fin').value;
                var Rresponsable = document.getElementById('responsable').value;
                var Rpresupuesto = document.getElementById('presupuesto').value;
                
                var Rtipo_persona = document.querySelector('input[name="tipo_persona"]:checked');
                var Rtipo_profesor = document.getElementById('tipo_profesor').value;
                var Rsemestre = document.getElementById('semestre').value;


                var fechaInicioVal = ValidarF_Inicial(Rfecha_ini);
                var fechaFinalVal = ValidarF_Final(Rfecha_fin);
                var presupuestoVal = Validar_Presupuesto(Rpresupuesto);
                if (Rcodigo == '') {
                    alert('Ingrese Codigo');

                } else if (Rnombre == '') {
                    alert('Ingrese Nombre');

                } else if (Rtipo == '') {
                    alert('Seleccionar Tipo proyecto');

                } else if (Rfecha_ini == '') {
                    alert('Ingrese Fecha Inicio');

                } else if (Rfecha_fin == '') {
                    alert('Ingrese Fecha Final');

                } else if (fechaInicioVal == 0) {
                    alert('Fecha iniciar mayor a 01-01-2022');

                } else if (fechaFinalVal == 0) {
                    alert('No menor a 01-01-2022 y no > 31-12-2022');

                } else if (Rresponsable == '') {
                    alert('Ingresar Responsable');

                } else if (presupuestoVal == 0) {
                    alert('Enteros. Maximo $50.000.000. No < 10.000.000');

                } else if (!Rtipo_persona) {
                    alert('Seleccionar Tipo Persona');

                } else if (Rtipo_profesor == '') {
                    alert('Seleccionar Tipo Profesor');

                } else if (Rsemestre == '') {
                    alert('Seleccionar Semestre');
                } else {
                    proyecto.push({
                        codigo: Rcodigo,
                        nombre: Rnombre,
                        tipo: Rtipo,
                        fecha_ini: Rfecha_ini,
                        fecha_fin: Rfecha_fin,
                        responsable: Rresponsable,
                        presupuesto: Rpresupuesto,
                        tipo_persona: Rtipo_persona.value,
                        tipo_profesor: Rtipo_profesor,
                        semestre: Rsemestre
                    });
                    console.log(proyecto);
                    limpiardatos();
                    mostrarDatos();
                }
            }




            function Editar(posicion, codigo) {
                const buscar = proyecto.find(proyecto => proyecto.codigo == codigo);
                document.getElementById('posicion').value = posicion;
                document.getElementById('codigo').value = buscar.codigo;
                document.getElementById('nombre').value = buscar.nombre;
                document.getElementById('tipo').value = buscar.tipo;
                document.getElementById('fecha_ini').value = buscar.fecha_ini;
                document.getElementById('fecha_fin').value = buscar.fecha_fin;
                document.getElementById('responsable').value = buscar.responsable;
                document.getElementById('presupuesto').value = buscar.presupuesto;
                document.getElementById('tipo_persona').checked = buscar.tipo_persona;
                document.getElementById('tipo_profesor').value = buscar.tipo_profesor;
                document.getElementById('semestre').value = buscar.semestre;
            }


            var btnAc = document.getElementById("btnActualizar")
            btnAc.addEventListener('click', actualizarProyecto)

            function actualizarProyecto() {
                // Validación
                var Rposicion = document.getElementById('posicion').value;
                var Rcodigo = document.getElementById('codigo').value;
                var Rnombre = document.getElementById('nombre').value;
                var Rtipo = document.getElementById('tipo').value;
                var Rfecha_ini = document.getElementById('fecha_ini').value;
                var Rfecha_fin = document.getElementById('fecha_fin').value;
                var Rresponsable = document.getElementById('responsable').value;
                var Rpresupuesto = document.getElementById('presupuesto').value;
                var Rtipo_persona = document.querySelector('input[name="tipo_persona"]:checked');
                var Rtipo_profesor = document.getElementById('tipo_profesor').value;
                var Rsemestre = document.getElementById('semestre').value;


                var fechaInicioVal = ValidarF_Inicial(Rfecha_ini);
                var fechaFinalVal = ValidarF_Final(Rfecha_fin);
                var presupuestoVal = Validar_Presupuesto(Rpresupuesto);
                if (Rcodigo == '') {
                    alert('Ingrese Codigo');

                } else if (Rnombre == '') {
                    alert('Ingrese Nombre');

                } else if (Rtipo == '') {
                    alert('Seleccionar Tipo proyecto');

                } else if (Rfecha_ini == '') {
                    alert('Ingrese Fecha Inicio');

                } else if (Rfecha_fin == '') {
                    alert('Ingrese Fecha Final');

                } else if (fechaInicioVal == 0) {
                    alert('Fecha iniciar mayor a 01-01-2022');

                } else if (fechaFinalVal == 0) {
                    alert('No menor a 01-01-2022 y no > 31-12-2022');

                } else if (Rresponsable == '') {
                    alert('Ingresar Responsable');

                } else if (presupuestoVal == 0) {
                    alert('Enteros. Maximo $50.000.000. No < 10.000.000');

                } else if (!Rtipo_persona) {
                    alert('Seleccionar Tipo Persona');

                } else if (Rtipo_profesor == '') {
                    alert('Seleccionar Tipo Profesor');

                } else if (Rsemestre == '') {
                    alert('Seleccionar Semestre');
                } else {
                    /*BUSCAR DATOS */
                    const actualizar = proyecto.splice(Rposicion, 1, {
                        codigo: Rcodigo,
                        nombre: Rnombre,
                        tipo: Rtipo,
                        fecha_ini: Rfecha_ini,
                        fecha_fin: Rfecha_fin,
                        responsable: Rresponsable,
                        presupuesto: Rpresupuesto,
                        tipo_persona: Rtipo_persona,
                        tipo_profesor: Rtipo_profesor,
                        semestre: Rsemestre

                    });
                    console.log('Actualizar: ', actualizar);
                    console.log(proyecto);
                    limpiardatos();
                    mostrarDatos();
                }
            }

            function Eliminar(posicion) {
                const eliminado = proyecto.splice(posicion, 1);
                console.log('Eliminado: ', eliminado);
                mostrarDatos();
                alert('Dato Eliminado');
            }

        </script>


    </body>
</html>